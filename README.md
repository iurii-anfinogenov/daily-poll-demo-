# Daily Poll Demo üó≥Ô∏è

–£—á–µ–±–Ω–æ–µ **stateless-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ-–æ–ø—Ä–æ—Å** –Ω–∞ FastAPI,  
–∫–æ—Ç–æ—Ä–æ–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **PostgreSQL** –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤–æ–ø—Ä–æ—Å–æ–≤/–≥–æ–ª–æ—Å–æ–≤  
–∏ **Redis** –¥–ª—è –∫—ç—à–∞ –∏ live-—Å—á—ë—Ç—á–∏–∫–æ–≤.  
–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω—É–∂–µ–Ω, —á—Ç–æ–±—ã –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –ø—Ä–∏—ë–º—ã DevOps-–¥–µ–ø–ª–æ—è  
(Ansible, Kaniko, Terraform, Kubernetes –∏ —Ç. –¥.) –Ω–∞–¥ –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–º –∫–æ–¥–æ–º.

---

## üì¶ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

| –°–ª–æ–π            | –°—Ç–µ–∫ (–≤–µ—Ä—Å–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) |
|-----------------|---------------------------|
| –Ø–∑—ã–∫ / API      | Python 3.12 ¬∑ FastAPI 0.115 |
| –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö     | PostgreSQL 16 |
| –ö—ç—à / Pub-Sub   | Redis 8 |
| Web-—Å–µ—Ä–≤–µ—Ä      | Uvicorn (ASGI) |
| –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è | Docker + docker-compose |

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# 1 ‚Äî –∫–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/<–≤–∞—à-–Ω–∏–∫>/daily-poll-demo.git
cd daily-poll-demo

# 2 ‚Äî —Å–æ–∑–¥–∞—ë–º —Ñ–∞–π–ª –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env      # –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ

# 3 ‚Äî —Å—Ç—Ä–æ–∏–º –∏ –∑–∞–ø—É—Å–∫–∞–µ–º –≤–µ—Å—å —Å—Ç–µ–∫
docker compose up --build
```

–û—Ç–∫—Ä–æ–π—Ç–µ <http://localhost:8000/docs> ‚Äî –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Swagger-UI.

---

## üîó –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

| –ú–µ—Ç–æ–¥ | URL        | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                     |
|-------|------------|--------------------------------|
| GET   | `/`        | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ        |
| GET   | `/poll`    | –ê–∫—Ç–∏–≤–Ω—ã–π –≤–æ–ø—Ä–æ—Å –¥–Ω—è            |
| POST  | `/vote`    | –û—Ç–¥–∞—Ç—å –≥–æ–ª–æ—Å (`choice_id`)     |
| GET   | `/results` | –¢–µ–∫—É—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è |

---

## ‚öôÔ∏è –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (`.env`)

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è     | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é                          | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                         |
|----------------|------------------------------------------------|------------------------------------|
| `DATABASE_URL` | `postgresql+psycopg2://user:pass@db:5432/poll` | —Å—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL    |
| `REDIS_HOST`   | `redis`                                        | —Ö–æ—Å—Ç Redis-—Å–µ—Ä–≤–∏—Å–∞                 |
| `REDIS_PORT`   | `6379`                                         | –ø–æ—Ä—Ç Redis                         |
| `CACHE_TTL`    | `86400` (24 —á)                                 | –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫—ç—à–∞ –≤–æ–ø—Ä–æ—Å–∞ (—Å–µ–∫)     |

---

## üèóÔ∏è –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞ –∫—É—Ä—Å–µ DevOps

| –ü—Ä–∏—ë–º                    | –ß—Ç–æ –ø—Ä–æ–±–æ–≤–∞—Ç—å                                                         |
|--------------------------|-----------------------------------------------------------------------|
| **docker-compose ‚Üí Helm**| –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ `api`, `db`, `redis` –≤ Helm-—á–∞—Ä—Ç                            |
| **Kaniko**               | —Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑ –≤–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞, –ø—Ä–æ–∫–∏–Ω—É–≤ `GIT_SHA`                     |
| **Terraform**            | –æ–ø–∏—Å–∞—Ç—å —Ä–µ—Å—É—Ä—Å—ã `kubernetes_deployment` –∏ `service`                   |
| **Ansible**              | —Ä–æ–ª—å, —Å—Ç–∞–≤—è—â–∞—è Docker –∏ –∑–∞–ø—É—Å–∫–∞—é—â–∞—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å `.env`                 |
| **HPA / –∞–≤—Ç–æ-—Å–∫–µ–π–ª**     | –¥–æ–±–∞–≤–∏—Ç—å `HorizontalPodAutoscaler` –ø–æ CPU / RPS                       |
| **Blue-Green / Canary**  | –≤—ã–∫–∞—Ç—ã–≤–∞—Ç—å –Ω–æ–≤—ã–π —Ç–µ–≥ –æ–±—Ä–∞–∑–∞, –ø—Ä–æ–≤–µ—Ä—è—Ç—å `/` –∏ `/results`               |

---

## üìö –ü–ª–∞–Ω—ã –Ω–∞ —Ä–∞–∑–≤–∏—Ç–∏–µ

- [ ] –º–∏–≥—Ä–∞—Ü–∏–∏ Alembic  
- [ ] –ø—Ä–æ–º–µ—Ç–µ–µ–≤—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏ `/metrics`  
- [ ] CI-workflow (lint ‚Üí build ‚Üí test ‚Üí push)  

---

## ü§ù Contributing

PR –∏ issue –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è!  
–ü–µ—Ä–µ–¥ –º—ë—Ä–¥–∂–µ–º –∑–∞–ø—É—Å–∫–∞–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã:

```bash
docker compose run --rm api pytest
```

---

## ü™™ License

MIT ¬© 2025 Iurii Anfinogenov
